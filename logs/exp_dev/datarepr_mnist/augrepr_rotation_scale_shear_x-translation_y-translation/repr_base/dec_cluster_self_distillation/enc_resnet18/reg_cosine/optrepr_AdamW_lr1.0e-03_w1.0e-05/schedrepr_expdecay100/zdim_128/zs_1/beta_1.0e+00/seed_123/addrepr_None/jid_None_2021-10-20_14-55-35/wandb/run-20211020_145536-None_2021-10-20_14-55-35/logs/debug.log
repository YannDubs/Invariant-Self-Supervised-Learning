2021-10-20 14:55:36,793 INFO    MainThread:3954558 [wandb_setup.py:_flush():69] setting env: {}
2021-10-20 14:55:36,794 WARNING MainThread:3954558 [wandb_setup.py:_flush():69] could not save program above cwd: /atlas/u/yanndubs/ISSL/main.py
2021-10-20 14:55:36,794 INFO    MainThread:3954558 [wandb_setup.py:_flush():69] setting login settings: {'anonymous': 'allow'}
2021-10-20 14:55:36,794 INFO    MainThread:3954558 [wandb_init.py:_log_setup():357] Logging user logs to /atlas/u/yanndubs/ISSL/logs/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35/wandb/run-20211020_145536-None_2021-10-20_14-55-35/logs/debug.log
2021-10-20 14:55:36,794 INFO    MainThread:3954558 [wandb_init.py:_log_setup():358] Logging internal logs to /atlas/u/yanndubs/ISSL/logs/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35/wandb/run-20211020_145536-None_2021-10-20_14-55-35/logs/debug-internal.log
2021-10-20 14:55:36,794 INFO    MainThread:3954558 [wandb_init.py:init():390] calling init triggers
2021-10-20 14:55:36,794 INFO    MainThread:3954558 [wandb_init.py:init():395] wandb.init called with sweep_config: {}
config: {}
2021-10-20 14:55:36,795 INFO    MainThread:3954558 [wandb_init.py:init():435] starting backend
2021-10-20 14:55:36,795 INFO    MainThread:3954558 [backend.py:_multiprocessing_setup():70] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2021-10-20 14:55:36,823 INFO    MainThread:3954558 [backend.py:ensure_launched():135] starting backend process...
2021-10-20 14:55:36,841 INFO    MainThread:3954558 [backend.py:ensure_launched():139] started backend process with pid: 3954640
2021-10-20 14:55:36,842 INFO    MainThread:3954558 [wandb_init.py:init():440] backend started and connected
2021-10-20 14:55:36,844 INFO    MainThread:3954558 [wandb_init.py:init():499] updated telemetry
2021-10-20 14:55:36,849 INFO    MainThread:3954558 [wandb_init.py:init():522] communicating current version
2021-10-20 14:55:39,090 INFO    MainThread:3954558 [wandb_init.py:init():527] got version response upgrade_message: "wandb version 0.12.5 is available!  To upgrade, please run:\n $ pip install wandb --upgrade"

2021-10-20 14:55:39,090 INFO    MainThread:3954558 [wandb_init.py:init():535] communicating run to backend with 30 second timeout
2021-10-20 14:55:39,311 INFO    MainThread:3954558 [wandb_init.py:init():562] starting run threads in backend
2021-10-20 14:55:44,316 INFO    MainThread:3954558 [wandb_run.py:_console_start():1651] atexit reg
2021-10-20 14:55:44,317 INFO    MainThread:3954558 [wandb_run.py:_redirect():1525] redirect: SettingsConsole.REDIRECT
2021-10-20 14:55:44,318 INFO    MainThread:3954558 [wandb_run.py:_redirect():1530] Redirecting console.
2021-10-20 14:55:44,320 INFO    MainThread:3954558 [wandb_run.py:_redirect():1586] Redirects installed.
2021-10-20 14:55:44,320 INFO    MainThread:3954558 [wandb_init.py:init():587] run started, returning control to user process
2021-10-20 14:55:44,320 INFO    MainThread:3954558 [wandb_run.py:_config_callback():878] config_cb None None {'n_param': 16118986}
2021-10-20 14:56:16,792 INFO    MainThread:3954558 [wandb_run.py:_config_callback():878] config_cb None None {'experiment': 'dev', 'job_id': 'None_2021-10-20_14-55-35', 'seed': 123, 'timeout': 60, 'time': 'None_2021-10-20_14-55-35', 'long_name_repr': 'exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None', 'long_name_pred': 'exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/datapred_mnist/augpred_rotation_scale_shear_x-translation_y-translation/optpred_AdamW_lr3.0e-04_w1.0e-05/schedpred_unifmultistep100/addpred_None', 'is_return': False, 'monitor_return': [], 'monitor_direction': [], 'is_no_save': False, 'paths/base_dir': '/atlas/u/yanndubs/ISSL', 'paths/data': '/atlas/u/yanndubs/ISSL/data', 'paths/work': '/atlas/u/yanndubs/ISSL/outputs/2021-10-20_14-55-35', 'paths/results': '/atlas/u/yanndubs/ISSL/results/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'paths/logs': '/atlas/u/yanndubs/ISSL/logs/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'paths/checkpoint': '/atlas/u/yanndubs/ISSL/checkpoints/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'paths/pretrained/save': '/atlas/u/yanndubs/ISSL/pretrained/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'paths/pretrained/load': '/atlas/u/yanndubs/ISSL/pretrained/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/*', 'paths/pretrained/staggered': 'None', 'other/is_debug': False, 'other/is_quick': True, 'other/hydra_job_id': 'None', 'other/add_repr': 'None', 'other/add_pred': 'None', 'other/git_hash': 'None', 'stage': 'repr', 'long_name': 'exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None', 'checkpoint/name': 'bestValLoss', 'checkpoint/kwargs/dirpath': '/atlas/u/yanndubs/ISSL/checkpoints/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'checkpoint/kwargs/monitor': 'val/repr/loss', 'checkpoint/kwargs/mode': 'min', 'checkpoint/kwargs/verbose': True, 'checkpoint/kwargs/save_last': True, 'checkpoint/kwargs/save_top_k': 1, 'checkpoint/kwargs/save_weights_only': False, 'data/mode': 'image', 'data/length': 2850, 'data/shape': [1, 32, 32], 'data/target_shape': [10], 'data/aux_shape': [1, 32, 32], 'data/aux_is_clf': True, 'data/target_is_clf': True, 'data/max_steps': 33, 'data/normalized': 'None', 'data/is_aux_already_represented': False, 'data/name': 'mnist', 'data/dataset': 'mnist', 'data/kwargs/data_dir': '/atlas/u/yanndubs/ISSL/data', 'data/kwargs/batch_size': 256, 'data/kwargs/reload_dataloaders_every_n_epochs': 0, 'data/kwargs/num_workers': 2, 'data/kwargs/dataset_kwargs/is_normalize': False, 'data/kwargs/dataset_kwargs/a_augmentations': ['x-translation', 'y-translation', 'rotation', 'scale', 'shear'], 'data/kwargs/dataset_kwargs/aux_target': 'augmentation', 'data/kwargs/val_size': 0.05, 'evaluation/is_eval_on_test': True, 'evaluation/representor/ckpt_path': 'best', 'evaluation/representor/is_evaluate': True, 'evaluation/representor/is_online_eval': True, 'evaluation/predictor/ckpt_path': 'best', 'evaluation/predictor/is_evaluate': True, 'evaluation/predictor/is_eval_train': False, 'callbacks/is_force_no_additional_callback': False, 'callbacks/LearningRateMonitor/is_use': True, 'callbacks/LearningRateMonitor/kwargs/logging_interval': 'epoch', 'callbacks/GPUStatsMonitor/is_use': False, 'trainer/max_epochs': 3, 'trainer/progress_bar_refresh_rate': 10000, 'trainer/resume_from_checkpoint': 'None', 'trainer/gradient_clip_val': 3, 'trainer/reload_dataloaders_every_n_epochs': 0, 'trainer/log_every_n_steps': 10, 'trainer/val_check_interval': 1.0, 'trainer/gpus': 1, 'trainer/num_nodes': 1, 'trainer/precision': 16, 'trainer/accumulate_grad_batches': 1, 'trainer/sync_batchnorm': False, 'trainer/fast_dev_run': False, 'trainer/overfit_batches': 0.0, 'trainer/weights_summary': 'full', 'trainer/profiler': 'None', 'trainer/num_sanity_val_steps': 0, 'trainer/limit_val_batches': 0.2, 'trainer/limit_train_batches': 0.05, 'trainer/limit_test_batches': 0.05, 'data_repr/mode': '???', 'data_repr/length': '???', 'data_repr/shape': '???', 'data_repr/target_shape': '???', 'data_repr/balancing_weights': '???', 'data_repr/aux_shape': '???', 'data_repr/aux_is_clf': '???', 'data_repr/target_is_clf': '???', 'data_repr/max_steps': '???', 'data_repr/normalized': '???', 'data_repr/is_aux_already_represented': '???', 'data_repr/name': 'mnist', 'data_repr/dataset': 'mnist', 'data_repr/kwargs/data_dir': '/atlas/u/yanndubs/ISSL/data', 'data_repr/kwargs/batch_size': 256, 'data_repr/kwargs/reload_dataloaders_every_n_epochs': 0, 'data_repr/kwargs/num_workers': 2, 'data_repr/kwargs/dataset_kwargs/is_normalize': False, 'data_repr/kwargs/dataset_kwargs/a_augmentations': ['x-translation', 'y-translation', 'rotation', 'scale', 'shear'], 'data_repr/kwargs/dataset_kwargs/aux_target': 'augmentation', 'data_repr/kwargs/val_size': 0.05, 'encoder/name': 'resnet18', 'encoder/z_shape': 128, 'encoder/is_normalize_Z': True, 'encoder/kwargs/in_shape': [1, 32, 32], 'encoder/kwargs/out_shape': 128, 'encoder/kwargs/architecture': 'resnet', 'encoder/kwargs/arch_kwargs/base': 'resnet18', 'encoder/kwargs/family': 'deterministic', 'Z_processor/kwargs/in_shape': 128, 'Z_processor/kwargs/out_shape': 128, 'Z_processor/kwargs/architecture': 'identity', 'online_evaluator/name': 'mlp_h2048_l2', 'online_evaluator/kwargs/in_shape': 128, 'online_evaluator/kwargs/out_shape': [10], 'online_evaluator/kwargs/architecture': 'mlp', 'online_evaluator/kwargs/arch_kwargs/hid_dim': 2048, 'online_evaluator/kwargs/arch_kwargs/norm_layer': 'batchnorm', 'online_evaluator/kwargs/arch_kwargs/n_hid_layers': 2, 'online_evaluator/kwargs/arch_kwargs/activation': 'ReLU', 'online_evaluator/kwargs/arch_kwargs/dropout_p': 0.0, 'online_evaluator/kwargs/is_classification': True, 'optimizer_issl/name': 'AdamW_lr1.0e-03_w1.0e-05', 'optimizer_issl/mode': 'AdamW', 'optimizer_issl/kwargs/lr': 0.001, 'optimizer_issl/kwargs/weight_decay': 1e-05, 'scheduler_issl/name': 'expdecay100', 'scheduler_issl/modes': ['expdecay'], 'scheduler_issl/kwargs/expdecay/decay_factor': 100, 'scheduler_issl/kwargs/expdecay/epochs': 3, 'optimizer_eval/name': 'AdamW_lr3.0e-04_w1.0e-05', 'optimizer_eval/mode': 'AdamW', 'optimizer_eval/kwargs/lr': 0.0003, 'optimizer_eval/kwargs/weight_decay': 1e-05, 'scheduler_eval/name': 'expdecay100', 'scheduler_eval/modes': ['expdecay'], 'scheduler_eval/kwargs/expdecay/decay_factor': 100, 'scheduler_eval/kwargs/expdecay/epochs': 3, 'checkpoint_repr/name': 'bestValLoss', 'checkpoint_repr/kwargs/dirpath': '/atlas/u/yanndubs/ISSL/checkpoints/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'checkpoint_repr/kwargs/monitor': 'val/repr/loss', 'checkpoint_repr/kwargs/mode': 'min', 'checkpoint_repr/kwargs/verbose': True, 'checkpoint_repr/kwargs/save_last': True, 'checkpoint_repr/kwargs/save_top_k': 1, 'checkpoint_repr/kwargs/save_weights_only': False, 'data_pred/mode': '???', 'data_pred/length': '???', 'data_pred/shape': '???', 'data_pred/target_shape': '???', 'data_pred/balancing_weights': '???', 'data_pred/aux_shape': '???', 'data_pred/aux_is_clf': '???', 'data_pred/target_is_clf': '???', 'data_pred/max_steps': '???', 'data_pred/normalized': '???', 'data_pred/is_aux_already_represented': '???', 'data_pred/name': 'mnist', 'data_pred/dataset': 'mnist', 'data_pred/kwargs/data_dir': '/atlas/u/yanndubs/ISSL/data', 'data_pred/kwargs/batch_size': 128, 'data_pred/kwargs/reload_dataloaders_every_n_epochs': 0, 'data_pred/kwargs/num_workers': 2, 'data_pred/kwargs/dataset_kwargs/is_normalize': False, 'data_pred/kwargs/dataset_kwargs/a_augmentations': ['x-translation', 'y-translation', 'rotation', 'scale', 'shear'], 'data_pred/kwargs/dataset_kwargs/aux_target': 'augmentation', 'data_pred/kwargs/val_size': 0.05, 'data_pred/kwargs/val_batch_size': 128, 'predictor/name': 'mlp_h2048_l2', 'predictor/is_skip': False, 'predictor/is_train': True, 'predictor/kwargs/arch_kwargs/hid_dim': 2048, 'predictor/kwargs/arch_kwargs/norm_layer': 'batchnorm', 'predictor/kwargs/arch_kwargs/n_hid_layers': 2, 'predictor/kwargs/arch_kwargs/activation': 'ReLU', 'predictor/kwargs/arch_kwargs/dropout_p': 0.0, 'predictor/kwargs/architecture': 'mlp', 'optimizer_pred/name': 'AdamW_lr3.0e-04_w1.0e-05', 'optimizer_pred/mode': 'AdamW', 'optimizer_pred/kwargs/lr': 0.0003, 'optimizer_pred/kwargs/weight_decay': 1e-05, 'scheduler_pred/name': 'unifmultistep100', 'scheduler_pred/modes': ['UniformMultiStepLR'], 'scheduler_pred/kwargs/UniformMultiStepLR/decay_factor': 100, 'scheduler_pred/kwargs/UniformMultiStepLR/k_steps': 3, 'scheduler_pred/kwargs/UniformMultiStepLR/epochs': 3, 'checkpoint_pred/name': 'bestValLoss', 'checkpoint_pred/kwargs/dirpath': '/atlas/u/yanndubs/ISSL/checkpoints/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'checkpoint_pred/kwargs/monitor': 'val/repr/loss', 'checkpoint_pred/kwargs/mode': 'min', 'checkpoint_pred/kwargs/verbose': True, 'checkpoint_pred/kwargs/save_last': True, 'checkpoint_pred/kwargs/save_top_k': 1, 'checkpoint_pred/kwargs/save_weights_only': False, 'user': 'yanndubs', 'wandb_entity': 'issl', 'logger/name': 'wandb', 'logger/is_can_plot_img': True, 'logger/kwargs/save_dir': '/atlas/u/yanndubs/ISSL/logs/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'logger/kwargs/name': 'None_2021-10-20_14-55-35', 'logger/kwargs/project': 'issl', 'logger/kwargs/entity': 'issl', 'logger/kwargs/group': 'dev', 'logger/kwargs/offline': False, 'logger/kwargs/reinit': False, 'logger/kwargs/id': 'None_2021-10-20_14-55-35', 'logger/wandb_kwargs/tags': ['dev', 'quick'], 'logger/wandb_kwargs/anonymous': True, 'logger/wandb_kwargs/project': 'tmp', 'data_feat/kwargs/batch_size': 128, 'data_feat/kwargs/val_batch_size': 128, 'representor/name': 'base', 'representor/is_on_the_fly': True, 'representor/is_train': True, 'representor/is_use_init': False, 'representor/loss/beta': 1, 'representor/loss/beta_anneal': 'linear', 'decodability/name': 'cluster_self_distillation', 'decodability/is_reconstruct': False, 'decodability/kwargs/mode': 'cluster_self_distillation', 'decodability/kwargs/z_shape': 128, 'decodability/kwargs/loss': 'None', 'decodability/kwargs/is_ema': False, 'decodability/kwargs/is_process_Mx': False, 'decodability/kwargs/is_stop_grad': True, 'decodability/kwargs/is_aux_already_represented': False, 'decodability/kwargs/is_normalize_proj': True, 'decodability/kwargs/is_proj_pred_same': True, 'decodability/kwargs/predictor_kwargs/architecture': 'linear', 'decodability/kwargs/predictor_kwargs/out_shape': 128, 'decodability/kwargs/projector_kwargs/architecture': 'flatten', 'decodability/kwargs/projector_kwargs/out_shape': 128, 'decodability/kwargs/n_Mx': 3000, 'decodability/kwargs/freeze_Mx_epochs': 1, 'decodability/kwargs/src_tgt_comparison': 'symmetric', 'decodability/kwargs/temperature': 0.1, 'decodability/kwargs/queue_size': 30, 'decodability/kwargs/sinkhorn_kwargs/eps': 0.05, 'regularizer/name': 'cosine', 'regularizer/factor_beta': 1, 'regularizer/kwargs/loss': 'cosine', 'regularizer/kwargs/mode': 'coarsener', 'regularizer/kwargs/is_aux_already_represented': False, 'finetune/name': 'none'}
2021-10-20 14:56:56,457 INFO    MainThread:3954558 [wandb_run.py:_config_callback():878] config_cb None None {'experiment': 'dev', 'job_id': 'None_2021-10-20_14-55-35', 'seed': 123, 'timeout': 60, 'time': 'None_2021-10-20_14-55-35', 'long_name_repr': 'exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None', 'long_name_pred': 'exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/datapred_mnist/augpred_rotation_scale_shear_x-translation_y-translation/optpred_AdamW_lr3.0e-04_w1.0e-05/schedpred_unifmultistep100/addpred_None', 'is_return': False, 'monitor_return': [], 'monitor_direction': [], 'is_no_save': False, 'paths/base_dir': '/atlas/u/yanndubs/ISSL', 'paths/data': '/atlas/u/yanndubs/ISSL/data', 'paths/work': '/atlas/u/yanndubs/ISSL/outputs/2021-10-20_14-55-35', 'paths/results': '/atlas/u/yanndubs/ISSL/results/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'paths/logs': '/atlas/u/yanndubs/ISSL/logs/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'paths/checkpoint': '/atlas/u/yanndubs/ISSL/checkpoints/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'paths/pretrained/save': '/atlas/u/yanndubs/ISSL/pretrained/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'paths/pretrained/load': '/atlas/u/yanndubs/ISSL/pretrained/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/*', 'paths/pretrained/staggered': 'None', 'other/is_debug': False, 'other/is_quick': True, 'other/hydra_job_id': 'None', 'other/add_repr': 'None', 'other/add_pred': 'None', 'other/git_hash': 'None', 'stage': 'repr', 'long_name': 'exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None', 'checkpoint/name': 'bestValLoss', 'checkpoint/kwargs/dirpath': '/atlas/u/yanndubs/ISSL/checkpoints/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'checkpoint/kwargs/monitor': 'val/repr/loss', 'checkpoint/kwargs/mode': 'min', 'checkpoint/kwargs/verbose': True, 'checkpoint/kwargs/save_last': True, 'checkpoint/kwargs/save_top_k': 1, 'checkpoint/kwargs/save_weights_only': False, 'data/mode': 'image', 'data/length': 2850, 'data/shape': [1, 32, 32], 'data/target_shape': [10], 'data/aux_shape': [1, 32, 32], 'data/aux_is_clf': True, 'data/target_is_clf': True, 'data/max_steps': 33, 'data/normalized': 'None', 'data/is_aux_already_represented': False, 'data/name': 'mnist', 'data/dataset': 'mnist', 'data/kwargs/data_dir': '/atlas/u/yanndubs/ISSL/data', 'data/kwargs/batch_size': 256, 'data/kwargs/reload_dataloaders_every_n_epochs': 0, 'data/kwargs/num_workers': 2, 'data/kwargs/dataset_kwargs/is_normalize': False, 'data/kwargs/dataset_kwargs/a_augmentations': ['x-translation', 'y-translation', 'rotation', 'scale', 'shear'], 'data/kwargs/dataset_kwargs/aux_target': 'augmentation', 'data/kwargs/val_size': 0.05, 'evaluation/is_eval_on_test': True, 'evaluation/representor/ckpt_path': 'best', 'evaluation/representor/is_evaluate': True, 'evaluation/representor/is_online_eval': True, 'evaluation/predictor/ckpt_path': 'best', 'evaluation/predictor/is_evaluate': True, 'evaluation/predictor/is_eval_train': False, 'callbacks/is_force_no_additional_callback': False, 'callbacks/LearningRateMonitor/is_use': True, 'callbacks/LearningRateMonitor/kwargs/logging_interval': 'epoch', 'callbacks/GPUStatsMonitor/is_use': False, 'trainer/max_epochs': 3, 'trainer/progress_bar_refresh_rate': 10000, 'trainer/resume_from_checkpoint': 'None', 'trainer/gradient_clip_val': 3, 'trainer/reload_dataloaders_every_n_epochs': 0, 'trainer/log_every_n_steps': 10, 'trainer/val_check_interval': 1.0, 'trainer/gpus': 1, 'trainer/num_nodes': 1, 'trainer/precision': 16, 'trainer/accumulate_grad_batches': 1, 'trainer/sync_batchnorm': False, 'trainer/fast_dev_run': False, 'trainer/overfit_batches': 0.0, 'trainer/weights_summary': 'full', 'trainer/profiler': 'None', 'trainer/num_sanity_val_steps': 0, 'trainer/limit_val_batches': 0.2, 'trainer/limit_train_batches': 0.05, 'trainer/limit_test_batches': 0.05, 'data_repr/mode': '???', 'data_repr/length': '???', 'data_repr/shape': '???', 'data_repr/target_shape': '???', 'data_repr/balancing_weights': '???', 'data_repr/aux_shape': '???', 'data_repr/aux_is_clf': '???', 'data_repr/target_is_clf': '???', 'data_repr/max_steps': '???', 'data_repr/normalized': '???', 'data_repr/is_aux_already_represented': '???', 'data_repr/name': 'mnist', 'data_repr/dataset': 'mnist', 'data_repr/kwargs/data_dir': '/atlas/u/yanndubs/ISSL/data', 'data_repr/kwargs/batch_size': 256, 'data_repr/kwargs/reload_dataloaders_every_n_epochs': 0, 'data_repr/kwargs/num_workers': 2, 'data_repr/kwargs/dataset_kwargs/is_normalize': False, 'data_repr/kwargs/dataset_kwargs/a_augmentations': ['x-translation', 'y-translation', 'rotation', 'scale', 'shear'], 'data_repr/kwargs/dataset_kwargs/aux_target': 'augmentation', 'data_repr/kwargs/val_size': 0.05, 'encoder/name': 'resnet18', 'encoder/z_shape': 128, 'encoder/is_normalize_Z': True, 'encoder/kwargs/in_shape': [1, 32, 32], 'encoder/kwargs/out_shape': 128, 'encoder/kwargs/architecture': 'resnet', 'encoder/kwargs/arch_kwargs/base': 'resnet18', 'encoder/kwargs/family': 'deterministic', 'Z_processor/kwargs/in_shape': 128, 'Z_processor/kwargs/out_shape': 128, 'Z_processor/kwargs/architecture': 'identity', 'online_evaluator/name': 'mlp_h2048_l2', 'online_evaluator/kwargs/in_shape': 128, 'online_evaluator/kwargs/out_shape': [10], 'online_evaluator/kwargs/architecture': 'mlp', 'online_evaluator/kwargs/arch_kwargs/hid_dim': 2048, 'online_evaluator/kwargs/arch_kwargs/norm_layer': 'batchnorm', 'online_evaluator/kwargs/arch_kwargs/n_hid_layers': 2, 'online_evaluator/kwargs/arch_kwargs/activation': 'ReLU', 'online_evaluator/kwargs/arch_kwargs/dropout_p': 0.0, 'online_evaluator/kwargs/is_classification': True, 'optimizer_issl/name': 'AdamW_lr1.0e-03_w1.0e-05', 'optimizer_issl/mode': 'AdamW', 'optimizer_issl/kwargs/lr': 0.001, 'optimizer_issl/kwargs/weight_decay': 1e-05, 'scheduler_issl/name': 'expdecay100', 'scheduler_issl/modes': ['expdecay'], 'scheduler_issl/kwargs/expdecay/decay_factor': 100, 'scheduler_issl/kwargs/expdecay/epochs': 3, 'optimizer_eval/name': 'AdamW_lr3.0e-04_w1.0e-05', 'optimizer_eval/mode': 'AdamW', 'optimizer_eval/kwargs/lr': 0.0003, 'optimizer_eval/kwargs/weight_decay': 1e-05, 'scheduler_eval/name': 'expdecay100', 'scheduler_eval/modes': ['expdecay'], 'scheduler_eval/kwargs/expdecay/decay_factor': 100, 'scheduler_eval/kwargs/expdecay/epochs': 3, 'checkpoint_repr/name': 'bestValLoss', 'checkpoint_repr/kwargs/dirpath': '/atlas/u/yanndubs/ISSL/checkpoints/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'checkpoint_repr/kwargs/monitor': 'val/repr/loss', 'checkpoint_repr/kwargs/mode': 'min', 'checkpoint_repr/kwargs/verbose': True, 'checkpoint_repr/kwargs/save_last': True, 'checkpoint_repr/kwargs/save_top_k': 1, 'checkpoint_repr/kwargs/save_weights_only': False, 'data_pred/mode': '???', 'data_pred/length': '???', 'data_pred/shape': '???', 'data_pred/target_shape': '???', 'data_pred/balancing_weights': '???', 'data_pred/aux_shape': '???', 'data_pred/aux_is_clf': '???', 'data_pred/target_is_clf': '???', 'data_pred/max_steps': '???', 'data_pred/normalized': '???', 'data_pred/is_aux_already_represented': '???', 'data_pred/name': 'mnist', 'data_pred/dataset': 'mnist', 'data_pred/kwargs/data_dir': '/atlas/u/yanndubs/ISSL/data', 'data_pred/kwargs/batch_size': 128, 'data_pred/kwargs/reload_dataloaders_every_n_epochs': 0, 'data_pred/kwargs/num_workers': 2, 'data_pred/kwargs/dataset_kwargs/is_normalize': False, 'data_pred/kwargs/dataset_kwargs/a_augmentations': ['x-translation', 'y-translation', 'rotation', 'scale', 'shear'], 'data_pred/kwargs/dataset_kwargs/aux_target': 'augmentation', 'data_pred/kwargs/val_size': 0.05, 'data_pred/kwargs/val_batch_size': 128, 'predictor/name': 'mlp_h2048_l2', 'predictor/is_skip': False, 'predictor/is_train': True, 'predictor/kwargs/arch_kwargs/hid_dim': 2048, 'predictor/kwargs/arch_kwargs/norm_layer': 'batchnorm', 'predictor/kwargs/arch_kwargs/n_hid_layers': 2, 'predictor/kwargs/arch_kwargs/activation': 'ReLU', 'predictor/kwargs/arch_kwargs/dropout_p': 0.0, 'predictor/kwargs/architecture': 'mlp', 'optimizer_pred/name': 'AdamW_lr3.0e-04_w1.0e-05', 'optimizer_pred/mode': 'AdamW', 'optimizer_pred/kwargs/lr': 0.0003, 'optimizer_pred/kwargs/weight_decay': 1e-05, 'scheduler_pred/name': 'unifmultistep100', 'scheduler_pred/modes': ['UniformMultiStepLR'], 'scheduler_pred/kwargs/UniformMultiStepLR/decay_factor': 100, 'scheduler_pred/kwargs/UniformMultiStepLR/k_steps': 3, 'scheduler_pred/kwargs/UniformMultiStepLR/epochs': 3, 'checkpoint_pred/name': 'bestValLoss', 'checkpoint_pred/kwargs/dirpath': '/atlas/u/yanndubs/ISSL/checkpoints/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'checkpoint_pred/kwargs/monitor': 'val/repr/loss', 'checkpoint_pred/kwargs/mode': 'min', 'checkpoint_pred/kwargs/verbose': True, 'checkpoint_pred/kwargs/save_last': True, 'checkpoint_pred/kwargs/save_top_k': 1, 'checkpoint_pred/kwargs/save_weights_only': False, 'user': 'yanndubs', 'wandb_entity': 'issl', 'logger/name': 'wandb', 'logger/is_can_plot_img': True, 'logger/kwargs/save_dir': '/atlas/u/yanndubs/ISSL/logs/exp_dev/datarepr_mnist/augrepr_rotation_scale_shear_x-translation_y-translation/repr_base/dec_cluster_self_distillation/enc_resnet18/reg_cosine/optrepr_AdamW_lr1.0e-03_w1.0e-05/schedrepr_expdecay100/zdim_128/zs_1/beta_1.0e+00/seed_123/addrepr_None/jid_None_2021-10-20_14-55-35', 'logger/kwargs/name': 'None_2021-10-20_14-55-35', 'logger/kwargs/project': 'issl', 'logger/kwargs/entity': 'issl', 'logger/kwargs/group': 'dev', 'logger/kwargs/offline': False, 'logger/kwargs/reinit': False, 'logger/kwargs/id': 'None_2021-10-20_14-55-35', 'logger/wandb_kwargs/tags': ['dev', 'quick'], 'logger/wandb_kwargs/anonymous': True, 'logger/wandb_kwargs/project': 'tmp', 'data_feat/kwargs/batch_size': 128, 'data_feat/kwargs/val_batch_size': 128, 'representor/name': 'base', 'representor/is_on_the_fly': True, 'representor/is_train': True, 'representor/is_use_init': False, 'representor/loss/beta': 1, 'representor/loss/beta_anneal': 'linear', 'decodability/name': 'cluster_self_distillation', 'decodability/is_reconstruct': False, 'decodability/kwargs/mode': 'cluster_self_distillation', 'decodability/kwargs/z_shape': 128, 'decodability/kwargs/loss': 'None', 'decodability/kwargs/is_ema': False, 'decodability/kwargs/is_process_Mx': False, 'decodability/kwargs/is_stop_grad': True, 'decodability/kwargs/is_aux_already_represented': False, 'decodability/kwargs/is_normalize_proj': True, 'decodability/kwargs/is_proj_pred_same': True, 'decodability/kwargs/predictor_kwargs/architecture': 'linear', 'decodability/kwargs/predictor_kwargs/out_shape': 128, 'decodability/kwargs/projector_kwargs/architecture': 'flatten', 'decodability/kwargs/projector_kwargs/out_shape': 128, 'decodability/kwargs/n_Mx': 3000, 'decodability/kwargs/freeze_Mx_epochs': 1, 'decodability/kwargs/src_tgt_comparison': 'symmetric', 'decodability/kwargs/temperature': 0.1, 'decodability/kwargs/queue_size': 30, 'decodability/kwargs/sinkhorn_kwargs/eps': 0.05, 'regularizer/name': 'cosine', 'regularizer/factor_beta': 1, 'regularizer/kwargs/loss': 'cosine', 'regularizer/kwargs/mode': 'coarsener', 'regularizer/kwargs/is_aux_already_represented': False, 'finetune/name': 'none'}
2021-10-20 14:57:07,185 INFO    MainThread:3954558 [wandb_run.py:_atexit_cleanup():1621] got exitcode: 1
2021-10-20 14:57:07,185 INFO    MainThread:3954558 [wandb_run.py:_restore():1593] restore
2021-10-20 14:57:09,302 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 696
  total_bytes: 696
}

2021-10-20 14:57:09,536 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 1
}
pusher_stats {
  uploaded_bytes: 696
  total_bytes: 696
}

2021-10-20 14:57:10,089 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 5
}
pusher_stats {
  uploaded_bytes: 696
  total_bytes: 39369
}

2021-10-20 14:57:10,192 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 696
  total_bytes: 41632
}

2021-10-20 14:57:10,295 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 41632
  total_bytes: 41632
}

2021-10-20 14:57:10,397 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 41632
  total_bytes: 41632
}

2021-10-20 14:57:10,499 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 41632
  total_bytes: 41632
}

2021-10-20 14:57:10,601 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 41632
  total_bytes: 41632
}

2021-10-20 14:57:10,873 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 41632
  total_bytes: 41632
}

2021-10-20 14:57:11,160 INFO    MainThread:3954558 [wandb_run.py:_wait_for_finish():1746] got exit ret: done: true
exit_result {
}
file_counts {
  wandb_count: 6
}
pusher_stats {
  uploaded_bytes: 41632
  total_bytes: 41632
}
local_info {
}

2021-10-20 14:57:13,108 INFO    MainThread:3954558 [wandb_run.py:_append_history():1959] rendering history
2021-10-20 14:57:13,109 INFO    MainThread:3954558 [wandb_run.py:_append_summary():1914] rendering summary
2021-10-20 14:57:13,109 INFO    MainThread:3954558 [wandb_run.py:_append_files():2009] logging synced files
